<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Influencer Life Deluxe</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
  body {
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #c9d6ff, #e2e2e2);
    font-family: 'Montserrat', sans-serif;
    color: #222;
    display: flex; justify-content: center; min-height: 100vh; align-items: flex-start;
  }
  .container {
    max-width: 720px;
    background: #fff;
    margin: 20px;
    border-radius: 14px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    padding: 20px 24px;
    user-select: none;
  }
  h1 {
    margin: 0 0 12px 0;
    font-weight: 700;
    text-align: center;
    color: #3f51b5;
  }
  .section {
    margin-bottom: 24px;
  }
  label {
    display: block;
    font-weight: 600;
    margin-bottom: 6px;
    color: #444;
  }
  input[type=text], select {
    width: 100%;
    padding: 8px 10px;
    border-radius: 8px;
    border: 1.5px solid #aaa;
    font-size: 14px;
    transition: border-color 0.3s;
  }
  input[type=text]:focus, select:focus {
    border-color: #3f51b5;
    outline: none;
  }
  button {
    background: #3f51b5;
    color: white;
    border: none;
    padding: 12px 16px;
    font-weight: 700;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 8px;
    width: 100%;
    transition: background 0.3s;
  }
  button:disabled {
    background: #aab3d9;
    cursor: not-allowed;
  }
  button:hover:not(:disabled) {
    background: #303f9f;
  }
  .stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 18px;
    font-weight: 600;
    font-size: 15px;
  }
  .stat {
    background: #e3e9ff;
    padding: 10px 14px;
    border-radius: 10px;
    min-width: 90px;
    text-align: center;
    box-shadow: inset 0 2px 4px #bbcdfd;
  }
  .upgrades {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(160px,1fr));
    gap: 14px;
  }
  .upgrade-card {
    background: #f4f7ff;
    border-radius: 12px;
    padding: 14px 12px;
    box-shadow: inset 0 0 8px #c5cee7;
    text-align: center;
  }
  .upgrade-card h4 {
    margin: 0 0 8px 0;
    font-weight: 700;
    font-size: 16px;
    color: #354496;
  }
  .upgrade-card button {
    width: auto;
    margin-top: 10px;
    font-weight: 600;
    font-size: 14px;
  }
  .videos-list {
    max-height: 220px;
    overflow-y: auto;
    border: 1.5px solid #ddd;
    border-radius: 10px;
    background: #fafaff;
    padding: 10px;
  }
  .video-item {
    border-bottom: 1px solid #d2d7ff;
    padding: 6px 4px;
    font-size: 14px;
    display: flex;
    justify-content: space-between;
    color: #2c2c2c;
  }
  .video-item:last-child {
    border-bottom: none;
  }
  .video-title {
    font-weight: 600;
    max-width: 50%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .video-stats {
    min-width: 180px;
    text-align: right;
    font-size: 13px;
    color: #555;
  }
  .milestones {
    background: #eef4ff;
    padding: 12px;
    border-radius: 12px;
    box-shadow: inset 0 0 10px #c4d3ff;
  }
  .milestone {
    margin: 6px 0;
    font-weight: 600;
    color: #2c3a87;
  }
  .milestone.reached {
    color: #1e7e34;
  }
  .footer-buttons {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .footer-buttons button {
    flex-grow: 1;
    max-width: 160px;
  }
  .notification {
    position: fixed;
    top: 12px;
    right: 12px;
    background: #3f51b5;
    color: white;
    padding: 10px 18px;
    border-radius: 10px;
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
    font-weight: 700;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 9999;
  }
  .notification.show {
    opacity: 1;
    pointer-events: auto;
  }
  @media (max-width: 480px) {
    .stats {
      flex-direction: column;
      gap: 8px;
    }
    .stat {
      min-width: auto;
    }
    .upgrades {
      grid-template-columns: 1fr;
    }
    .footer-buttons {
      flex-direction: column;
    }
  }
</style>
</head>
<body>
<div class="container" role="main" aria-label="Influencer Life Game">

  <h1>Influencer Life Deluxe</h1>

  <div class="section">
    <label for="profileNameInput">Your Name:</label>
    <input type="text" id="profileNameInput" maxlength="24" placeholder="Enter your influencer name" aria-describedby="nameHelp" />
    <button id="saveNameBtn" aria-live="polite" aria-atomic="true">Save Name</button>
  </div>

  <div class="stats" aria-label="Player stats">
    <div class="stat" title="Current Day">Day: <span id="statDay">1</span></div>
    <div class="stat" title="Total Followers">Followers: <span id="statFollowers">0</span></div>
    <div class="stat" title="Total Money">$<span id="statMoney">0</span></div>
  </div>

  <div class="section">
    <label for="videoTypeSelect">Select Video Type:</label>
    <select id="videoTypeSelect" aria-label="Select video type">
      <option value="Vlog">Vlog</option>
      <option value="Tutorial">Tutorial</option>
      <option value="Prank">Prank</option>
      <option value="Live">Live Stream</option>
      <option value="Review">Review</option>
      <option value="Challenge">Challenge</option>
    </select>
    <label for="videoTitleInput" style="margin-top:8px;">Video Title:</label>
    <input type="text" id="videoTitleInput" maxlength="30" placeholder="Name your video" aria-label="Video title" />
    <button id="postVideoBtn">Post Video</button>
  </div>

  <div class="section">
    <h3>Your Videos</h3>
    <div class="videos-list" id="videosList" aria-live="polite" aria-relevant="additions"></div>
  </div>

  <div class="section upgrades" aria-label="Upgrades available">
    <div class="upgrade-card" id="upgradeCamera">
      <h4>Camera</h4>
      <div>Level: <span id="cameraLevel">0</span></div>
      <div>Cost: $<span id="cameraCost">50</span></div>
      <button id="buyCameraBtn">Upgrade Camera</button>
    </div>
    <div class="upgrade-card" id="upgradeEditor">
      <h4>Editor PC</h4>
      <div>Level: <span id="editorLevel">0</span></div>
      <div>Cost: $<span id="editorCost">100</span></div>
      <button id="buyEditorBtn">Upgrade Editor</button>
    </div>
    <div class="upgrade-card" id="upgradeManager">
      <h4>Manager</h4>
      <div>Level: <span id="managerLevel">0</span></div>
      <div>Cost: $<span id="managerCost">250</span></div>
      <button id="buyManagerBtn">Hire Manager</button>
    </div>
  </div>

  <div class="section milestones" aria-label="Subscriber milestones">
    <h3>Subscriber Milestones</h3>
    <div id="milestonesContainer"></div>
  </div>

  <div class="footer-buttons">
    <button id="brandDealBtn">Try Brand Deal</button>
    <button id="resetBtn" style="background:#d9534f;">Reset All</button>
  </div>

</div>

<div class="notification" id="notification" role="alert" aria-live="assertive"></div>

<script>
  (() => {
    'use strict';

    // Initial game state
    const state = {
      profileName: 'Your Name',
      day: 1,
      followers: 0,
      money: 0,
      cameraLevel: 0,
      editorLevel: 0,
      managerLevel: 0,
      videos: [],
      milestonesReached: new Set(),
    };

    // Subscriber milestones thresholds & rewards
    const milestones = [
      { subs: 100, reward: 50 },
      { subs: 500, reward: 250 },
      { subs: 1000, reward: 600 },
      { subs: 5000, reward: 3500 },
      { subs: 10000, reward: 10000 },
      { subs: 50000, reward: 60000 },
    ];

    // Cost multiplier for upgrades per level
    const costMultiplier = 1.6;

    // Upgrade base costs
    const upgradeCosts = {
      camera: 50,
      editor: 100,
      manager: 250,
    };

    // DOM elements
    const el = {
      profileNameInput: document.getElementById('profileNameInput'),
      saveNameBtn: document.getElementById('saveNameBtn'),
      statDay: document.getElementById('statDay'),
      statFollowers: document.getElementById('statFollowers'),
      statMoney: document.getElementById('statMoney'),
      videoTypeSelect: document.getElementById('videoTypeSelect'),
      videoTitleInput: document.getElementById('videoTitleInput'),
      postVideoBtn: document.getElementById('postVideoBtn'),
      videosList: document.getElementById('videosList'),
      cameraLevel: document.getElementById('cameraLevel'),
      cameraCost: document.getElementById('cameraCost'),
      buyCameraBtn: document.getElementById('buyCameraBtn'),
      editorLevel: document.getElementById('editorLevel'),
      editorCost: document.getElementById('editorCost'),
      buyEditorBtn: document.getElementById('buyEditorBtn'),
      managerLevel: document.getElementById('managerLevel'),
      managerCost: document.getElementById('managerCost'),
      buyManagerBtn: document.getElementById('buyManagerBtn'),
      milestonesContainer: document.getElementById('milestonesContainer'),
      brandDealBtn: document.getElementById('brandDealBtn'),
      resetBtn: document.getElementById('resetBtn'),
      notification: document.getElementById('notification'),
    };

    // Save/load
    function saveGame() {
      // Save milestonesReached as array, since Set cannot be saved directly in JSON
      const saveData = {...state, milestonesReached: [...state.milestonesReached]};
      localStorage.setItem('influencerLifeDeluxeSave', JSON.stringify(saveData));
    }
    function loadGame() {
      const data = localStorage.getItem('influencerLifeDeluxeSave');
      if (data) {
        try {
          const loaded = JSON.parse(data);
          Object.assign(state, loaded);
          // milestonesReached stored as array, convert back to Set
          if (loaded.milestonesReached && Array.isArray(loaded.milestonesReached)) {
            state.milestonesReached = new Set(loaded.milestonesReached);
          } else {
            state.milestonesReached = new Set();
          }
          // Defensive defaults:
          if (!Array.isArray(state.videos)) state.videos = [];
        } catch {
          console.warn('Failed to parse save data. Resetting save.');
          resetGame();
        }
      }
    }

    // Helpers
    function showNotification(msg) {
      el.notification.textContent = msg;
      el.notification.classList.add('show');
      setTimeout(() => {
        el.notification.classList.remove('show');
      }, 3000);
    }

    function calcUpgradeCost(base, level) {
      return Math.floor(base * Math.pow(costMultiplier, level));
    }

    // Update upgrade UI
    function updateUpgradeUI() {
      const cameraCost = calcUpgradeCost(upgradeCosts.camera, state.cameraLevel);
      el.cameraLevel.textContent = state.cameraLevel;
      el.cameraCost.textContent = cameraCost;
      el.buyCameraBtn.disabled = state.money < cameraCost;

      const editorCost = calcUpgradeCost(upgradeCosts.editor, state.editorLevel);
      el.editorLevel.textContent = state.editorLevel;
      el.editorCost.textContent = editorCost;
      el.buyEditorBtn.disabled = state.money < editorCost;

      const managerCost = calcUpgradeCost(upgradeCosts.manager, state.managerLevel);
      el.managerLevel.textContent = state.managerLevel;
      el.managerCost.textContent = managerCost;
      el.buyManagerBtn.disabled = state.money < managerCost;
    }

    // Update milestone UI
    function updateMilestonesUI() {
      el.milestonesContainer.innerHTML = '';
      milestones.forEach(m => {
        const reached = state.followers >= m.subs;
        const reachedClass = reached ? 'reached' : '';
        if(reached && !state.milestonesReached.has(m.subs)) {
          state.milestonesReached.add(m.subs);
          showNotification(`Milestone reached: ${m.subs.toLocaleString()} subscribers! You earned $${m.reward}.`);
          state.money += m.reward;
          saveGame();
        }
        const div = document.createElement('div');
        div.className = `milestone ${reachedClass}`;
        div.textContent = `${m.subs.toLocaleString()} subscribers`;
        el.milestonesContainer.appendChild(div);
      });
    }

    // Update videos list UI
    function updateVideosUI() {
      el.videosList.innerHTML = '';
      if(state.videos.length === 0) {
        el.videosList.textContent = 'No videos posted yet.';
        return;
      }
      state.videos.slice().reverse().forEach((video, idx) => {
        const div = document.createElement('div');
        div.className = 'video-item';
        div.title = `Posted on day ${video.day}`;
        const titleDiv = document.createElement('div');
        titleDiv.className = 'video-title';
        titleDiv.textContent = video.title;
        const statsDiv = document.createElement('div');
        statsDiv.className = 'video-stats';
        statsDiv.textContent = `${video.type} | Views: ${video.views.toLocaleString()} | Subs: +${video.subsGained}`;
        div.appendChild(titleDiv);
        div.appendChild(statsDiv);
        el.videosList.appendChild(div);
      });
    }

    // Update main stats UI
    function updateStatsUI() {
      el.statDay.textContent = state.day;
      el.statFollowers.textContent = state.followers.toLocaleString();
      el.statMoney.textContent = state.money.toLocaleString();
      el.profileNameInput.value = state.profileName;
    }

    // Post a new video
    function postVideo() {
      const title = el.videoTitleInput.value.trim();
      if(title.length === 0) {
        alert('Please enter a video title.');
        return;
      }
      const type = el.videoTypeSelect.value;
      // Base subs & money gained from post - influenced by upgrades and randomness
      let baseSubs = 20 + Math.floor(Math.random()*30);
      let baseMoney = 10 + Math.floor(Math.random()*20);

      // Upgrades multiply earnings
      const cameraBonus = 1 + state.cameraLevel * 0.15;
      const editorBonus = 1 + state.editorLevel * 0.2;
      const managerBonus = 1 + state.managerLevel * 0.25;

      const totalBonus = cameraBonus * editorBonus * managerBonus;

      const subsGained = Math.floor(baseSubs * totalBonus);
      const moneyGained = Math.floor(baseMoney * totalBonus);

      state.followers += subsGained;
      state.money += moneyGained;

      const videoData = {
        day: state.day,
        type,
        title,
        views: Math.floor(subsGained * (1.5 + Math.random())), // views roughly proportional to subs gained
        subsGained,
      };

      state.videos.push(videoData);
      el.videoTitleInput.value = '';
      updateVideosUI();
      updateStatsUI();
      updateMilestonesUI();
      updateUpgradeUI();
      saveGame();
      showNotification(`Video posted! +${subsGained.toLocaleString()} subs, +$${moneyGained.toLocaleString()}`);
    }

    // Buy upgrades
    function buyUpgrade(upgradeName) {
      let levelKey = upgradeName + 'Level';
      let costKey = upgradeName + 'Cost';

      const cost = calcUpgradeCost(upgradeCosts[upgradeName], state[levelKey]);
      if(state.money >= cost) {
        state.money -= cost;
        state[levelKey]++;
        updateUpgradeUI();
        updateStatsUI();
        saveGame();
        showNotification(`${upgradeName.charAt(0).toUpperCase()+upgradeName.slice(1)} upgraded to level ${state[levelKey]}!`);
      } else {
        alert(`Not enough money to upgrade ${upgradeName}. Need $${cost}.`);
      }
    }

    // Brand deal attempt
    function tryBrandDeal() {
      if(state.followers < 100) {
        alert('You need at least 100 subscribers for a brand deal!');
        return;
      }
      const dealValue = Math.floor(state.followers / 10) + Math.floor(Math.random()*100);
      state.money += dealValue;
      updateStatsUI();
      saveGame();
      showNotification(`Brand deal success! You earned $${dealValue}.`);
    }

    // Advance day
    function nextDay() {
      state.day++;
      // Passive growth: small followers and money trickle, increased by upgrades (manager especially)
      const passiveSubs = Math.floor(Math.random() * 3) + state.managerLevel * 2;
      const passiveMoney = Math.floor(Math.random() * 4) + state.managerLevel * 3;

      state.followers += passiveSubs;
      state.money += passiveMoney;

      updateStatsUI();
      updateMilestonesUI();
      saveGame();
    }

    // Reset game
    function resetGame() {
      if(!confirm('Reset ALL progress? This cannot be undone.')) return;
      state.profileName = 'Your Name';
      state.day = 1;
      state.followers = 0;
      state.money = 0;
      state.cameraLevel = 0;
      state.editorLevel = 0;
      state.managerLevel = 0;
      state.videos = [];
      state.milestonesReached.clear();
      updateStatsUI();
      updateVideosUI();
      updateUpgradeUI();
      updateMilestonesUI();
      saveGame();
      showNotification('Game reset complete.');
    }

    // Event listeners
    el.saveNameBtn.addEventListener('click', () => {
      const name = el.profileNameInput.value.trim();
      if(name.length === 0) {
        alert('Name cannot be empty.');
        return;
      }
      state.profileName = name;
      updateStatsUI();
      saveGame();
      showNotification(`Name saved as "${name}"`);
    });

    el.postVideoBtn.addEventListener('click', postVideo);
    el.buyCameraBtn.addEventListener('click', () => buyUpgrade('camera'));
    el.buyEditorBtn.addEventListener('click', () => buyUpgrade('editor'));
    el.buyManagerBtn.addEventListener('click', () => buyUpgrade('manager'));
    el.brandDealBtn.addEventListener('click', tryBrandDeal);
    el.resetBtn.addEventListener('click', resetGame);

    // Initialize UI and load save
    loadGame();
    updateStatsUI();
    updateVideosUI();
    updateUpgradeUI();
    updateMilestonesUI();

    // Start day interval: 1 minute = 1 day
    setInterval(nextDay, 60000);

  })();
</script>
</body>
</html>
